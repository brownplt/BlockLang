<html>
<head>
    <script type="text/javascript" src="closure-library/closure/goog/base.js"></script>
    <script type="text/javascript" src="ray-deps.js"></script>
    <title>UI Demo</title>
    <link rel="stylesheet" type="text/css" href="ink-2.2.0/css/ink-custom.css">
    <!-- <link rel="stylesheet/less" type="text/css" href="ray/ui/less/ui.less">
    <script type="text/javascript" src="less.js"></script> -->
    <link rel="stylesheet" type="text/css" href="ray/ui/css/ui.css">
    <script type="text/javascript">
        /** Ray Imports */
        goog.require('Ray.Main');
        goog.require('Ray.Shared');
        goog.require('Ray.UI');
        /** Closure Library Imports */
        goog.require('goog.dom');
        goog.require('goog.events');
        goog.require('goog.events.EventType');
    </script>
</head>
<body>
<div class="ink-grid">
<div id="header" class="column-group">
    <div class="large-50">

        <div id="create_function_button"
             class="goog-flat-button goog-inline-block header-item"
             title="Define a new function to use in your program">
            ...
        </div>


        <div id="run_button"
             class="run-button goog-inline-block header-item"
             title="Evaluate the program in the main workspace">
            ...
        </div>
    </div>
    <div class="large-50 content-right">
        <div id="results" class="header-item"></div>
    </div>
</div>
<div class="body">
    <div id="workspace_tabs" class="goog-tab-bar goog-tab-bar-top">
        <div id="tab_blockly_main" class="goog-tab goog-tab-selected">Main Workspace</div>
    </div>
    <div class="goog-tab-bar-clear"></div>
    <div id="workspace_container" class="goog-tab-content">
        <div class="container">
            <iframe id="blockly_main" src="Javascript:''"></iframe>
        </div>
    </div>
</div>
</div>
<script>
    Ray.Main.initializeLibrary();
    var blocks = Ray.Main.createBlocks();
    Ray.Shared.setBlocks(blocks);
    Ray.Shared.attachToBlockly(Blockly);

    Ray.UI.setupFunDefDialog(goog.dom.getDomHelper(document.body));

    Ray.UI.setupTabBar('workspace_tabs', 'blockly_main');

    Ray.UI.saveWorkspaceHeaderTabsContainer(goog.dom.getElement('header'),
                                            goog.dom.getElement('workspace_tabs'),
                                            goog.dom.getElement('workspace_container'));

    Ray.UI.resizeWorkspaceContainer();
    goog.events.listen(window, goog.events.EventType.RESIZE, Ray.UI.resizeWorkspaceContainer);

    Ray.UI.setupCreateFunButton(goog.dom.getElement('create_function_button'));

    Ray.UI.setupRunButton(goog.dom.getElement('run_button'));

    Ray.UI.setupResultsDom(goog.dom.getElement('results'));


    Ray.UI.funDefDialog.onCreate(Ray.UI.createFunBlockly);

    Ray.UI.listenForTabChanges();

    //Ray.Main.initializeMainBlocklyDom();
    Ray.UI.initializeFunDefBlocklyDom();
    Ray.UI.loadMainBlockly(Ray.UI.Util.mainBlockly());

    goog.events.listen(window, goog.events.EventType.BEFOREUNLOAD, function(e) {
        return 'If you leave the page, any unsaved programs will be lost!';
    });
</script>
</body>

</html>